diff -durN -x '*~' strace-4.5.1.orig/configure.ac strace-4.5.1/configure.ac
--- strace-4.5.1.orig/configure.ac	2003-11-07 00:44:09.000000000 +0100
+++ strace-4.5.1/configure.ac	2004-12-21 09:51:41.882695896 +0100
@@ -190,7 +190,7 @@
 AC_CHECK_FUNCS(sigaction strerror strsignal pread sys_siglist _sys_siglist getdents mctl prctl sendmsg inet_ntop if_indextoname)
 AC_CHECK_HEADERS([sys/reg.h sys/filio.h sys/acl.h sys/asynch.h sys/door.h stropts.h sys/conf.h sys/stream.h sys/tihdr.h sys/tiuser.h sys/sysconfig.h ioctls.h sys/ioctl.h sys/ptrace.h termio.h linux/ptrace.h asm/reg.h sys/uio.h sys/aio.h  poll.h sys/poll.h sys/vfs.h asm/sysmips.h linux/utsname.h sys/nscsys.h], [], [])
 AC_CHECK_HEADERS([linux/icmp.h linux/in6.h linux/netlink.h linux/if_packet.h],
-                 [], [], [#include <linux/socket.h>])
+                 [], [], [#include <sys/socket.h>])
 AC_CHECK_HEADERS([asm/sigcontext.h], [], [], [#include <signal.h>])
 AC_CHECK_HEADERS([netinet/tcp.h netinet/udp.h],,, [#include <netinet/in.h>])
 
--- strace-4.5.1/bjm.c.orig	2002-11-06 15:00:12.000000000 +0100
+++ strace-4.5.1/bjm.c	2004-01-17 12:15:45.707269760 +0100
@@ -42,7 +42,6 @@
 #include <sys/user.h>
 #include <sys/syscall.h>
 #include <signal.h>
-#include <linux/linkage.h>
 
 /* Bits of module.flags.  */
 
